# 1. CBV
- URL íŒ¨í„´ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ í´ë˜ìŠ¤ ì‚¬ìš©í•˜ëŠ” ë·°ì´ë‹¤.
- FBVì™€ëŠ” ë‹¬ë¦¬ í´ë˜ìŠ¤ë¡œ êµ¬í˜„ë˜ë¯€ë¡œ, ì¢€ ë” ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.

## ğŸ“ŒListView
- ì¼ë°˜ì ì¸ ë·° ë°˜í™˜ í•¨ìˆ˜
   - `django_prj/blog/urls.py`
      ```py
      urlpatterns =[path("", views.index, name='blog'),]
      ```
   - `django_prj/blog/views.py`
   ```py
   def index(request):
      posts = Post.objects.all().order_by('-pk')
      return render(request, "blog/index.html", {"posts": posts})
   ```

- ìœ„ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” CBV í´ë˜ìŠ¤
   - `django_prj/blog/urls.py`
      ```py
      urlpatterns =[path("", views.PostList.as_view(), name='blog'),]
      ```
   - `django_prj/blog/views.py`
      ```py
      from django.views.generic import ListView

      class PostList(ListView):
         model = Post
         template_name = "blog/index.html" # ë·° íŒŒì¼ ì§€ì •
         context_object_name = "posts" # ì»¨í…ìŠ¤íŠ¸ ì´ë¦„ 
         ordering = ['-pk'] # ì •ë ¬
      ```
      - `model`: ì´ ë·°ì—ì„œ ë°ì´í„°ë¥¼ í‘œì‹œí•  ëª¨ë¸
      - `template_name`: `'model_list.html'` ë Œë”ë§ë  í˜ì´ì§€ì˜ ê¸°ë³¸ ê°’
      - `context_object_name`: `'model_list'` ëª¨ë¸ê³¼ ë§¤í•‘ë  ì»¨í…ìŠ¤íŠ¸ì˜ í‚¤ ê°’

### í˜ì´ì§•
- `paginate_by`
- `Pagination`ì„ ì‚¬ìš©
- í˜„ í˜ì´ì§€ì—ì„œ ë‹¤ìŒ í˜ì´ì§€ë˜ëŠ” ì´ì „ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ë°˜í™˜í•œë‹¤.
- 


## ğŸ“ŒDetailView
- ë·° ë°˜í™˜ í•¨ìˆ˜
   - `django_prj/blog/urls.py`
      ```py
      urlpatterns =[path("<int:post_pk>/", views.detail_post, name='detail'),]
      ```
   - `django_prj/blog/views.py`
      ```py
      def detail_post(request, post_pk):
         post = Post.objects.get(pk=post_pk)
         return render(request, "blog/detail.html", {"post": post})
      ```

- CBV í´ë˜ìŠ¤
   - `django_prj/blog/urls.py`
      ```py
         urlpatterns =[path("<int:post_pk>/", views.PostDetail.as_view(), name='detail'),]
      ```
   - `django_prj/blog/views.py`
      ```py
      from django.views.generic import DetailView
      
      class PostDetail(DetailView):
         model = Post
         template_name = "blog/detail.html"
         context_object_name = "post"
         pk_url_kwarg = 'post_pk'
      ```
      - `pk_url_kwarg`: urlì—ì„œ ë§¤í•‘ë  pk ê°’ (ê¸°ë³¸ ê°’: `'pk'`)

## ğŸ“ŒCreateView

- `django_prj/blog/views.py`
   ```py
   from .models import Post
   from django.views.generic import CreateView

   class PostCreate(CreateView):
      model = Post
      fields = [
      'title', 'hook_text', 'content', 
      'head_image','file_upload', 'category', 
      'tags'
      ]
   ```
   - `fields`: í•´ë‹¹ Entity ëª¨ë¸ì—ì„œ ê°€ì ¸ì˜¬ í•„ë“œ ë¦¬ìŠ¤íŠ¸
   - `template_name`: `'model_form.html'` ë Œë”ë§ë  í˜ì´ì§€ì˜ ê¸°ë³¸ ê°’
   - `success_url`: POST ì „ì†¡ ì„±ê³µ í›„, ì´ë™í•  urlì„ ì§€ì •í•œë‹¤.
   - `form_valid()`: í•´ë‹¹ ë©”ì„œë“œì™€ success_urlë¥¼ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´, CreateViewì˜ ê¸°ë³¸ì ì¸ ë‹¤ìŒê³¼ ê°™ì€ ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤.
      1. ì „ì†¡ëœ í¼ ë°ì´í„°ì˜ *ìœ íš¨ì„± ê²€ì‚¬*ë¥¼ í•œë‹¤.
      1. ëª¨ë¸ *ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±*í•œë‹¤.(í¼ ë°ì´í„°ê°€ ìœ íš¨í•œ ê²½ìš°, í•´ë‹¹ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëª¨ë¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±)
      1. ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ *DBì— ì €ì¥*í•œë‹¤.
      1. í•´ë‹¹ ëª¨ë¸ì˜ *get_absolute_url() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ë¦¬ë‹¤ì´ë ‰ì…˜í•  url*ì„ ê°€ì ¸ì˜¨ë‹¤.
         - ë‹¨ í•´ë‹¹ ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ ìˆì§€ ì•Šì„ ê²½ìš°, success_urlì— ì§€ì •ëœ ê°’ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ì„ í•œë‹¤.
         - ë§Œì•½  get_absolute_url()ì™€ success_url ëª¨ë‘ ëª…ì‹œë˜ì§€ ì•Šì„ ê²½ìš°, ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

- `django_prj/blog/urls.py`
   ```py
   from django.urls import path
   from . import views

   urlpatterns = [
      path("create_post/",views.PostCreate.as_view()),
   ]
   ```

- `django_prj/blog/templates/blog/post_form.html`
   ```html
   <form method="post" enctype="multipart/form-data">
      <table>
         {% csrf_token %}
         {{form}}
      </table>
      <input type="submit">
   </form>
   ```
   - `{{form}}`: í…œí”Œë¦¿ì—ì„œ ì „ì²´ formì„ ë Œë”ë§í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ì´ë‹¤.
   - ì´ ë³€ìˆ˜ëŠ” formì— ëŒ€í•œ HTMLë§ˆí¬ì—…ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©°, í¼ì˜ í•„ë“œ, ë ˆì´ë¸”, ì…ë ¥ ìš”ì†Œ, ê·¸ë¦¬ê³  ê´€ë ¨ëœ ì—ëŸ¬ë‚˜ ìœ íš¨ì„± ê²€ì‚¬ ë©”ì‹œì§€ ë“±ì´ í¬í•¨ëœë‹¤.
   - `{% csrf_token %}`: POST ìš”ì²­ì— ëŒ€í•´ì„œë§Œ CSRT Tokenì„ ë°œê¸‰í•˜ê³  ì²´í¬í•œë‹¤. ë³´ì•ˆì„ ìœ„í•´ ë´‡ì— ì˜í•´ ìë™ìœ¼ë¡œ ì‘ì„±ëœ ê²Œì‹œíŒì— ë„ë°°ë˜ì§€ ì•Šë„ë¡ ë§‰ì•„ì¤€ë‹¤.

- `django_prj/blog/views.py`
   ```py
   from .models import Post
   from django.shortcuts import redirect
   from django.views.generic import CreateView
   from django.contrib.auth.mixins import LoginRequiredMixin

   class PostCreate(LoginRequiredMixin, CreateView):
      model = Post
      fields = [
      'title', 'hook_text', 'content', 
      'head_image','file_upload', 'category', 
      'tags'
      ]
      
      def form_valid(self, form):
         current_user = self.request.user
         if current_user.is_authenticated and current_user.is_staff or current_user.is_superuser:
            form.instance.author = current_user
            return super().form_valid(form)
      return redirect('/blog/')
   ```
   - `current_user = self.request.user`: ìš”ì²­ì—ì„œ ë¡œê·¸ì¸ëœ ìœ ì €ì˜ ê°€ì ¸ì˜¨ë‹¤.
   - `current_user.is_authenticated` : íšŒì› ë¡œê·¸ì¸ ì—¬ë¶€ íŒë³„
   - `current_user.is_staff` : ë¡œê·¸ì¸ëœ ìœ ì €ê°€ ìŠ¤íƒœë¸Œì¸ì§€ ì—¬ë¶€ íŒë³„
   - `current_user.is_superuser`: ë¡œê·¸ì¸ëœ ìœ ì €ê°€ ìŠˆí¼ìœ ì €ì¸ì§€ ì—¬ë¶€ íŒë³„
   - `form.instance.author = current_user`: createViewì—ì„œ ìƒì„±ëœ formì˜ instanceì—ì„œ authorë¥¼ current_userìœ¼ë¡œ ì €ì¥í•œë‹¤.

## ğŸ“ŒUpdateView
   ```py
   class PostUpdate(UpdateView):
      model = Post
      fields = [
      'title', 'hook_text', 'content', 
      'head_image','file_upload', 'category', 
      'tags'
      ]
   
   def dispatch(self, request, *args: Any, **kwargs: Any):
      current_user = self.request.user
      if current_user.is_authenticated and current_user == self.get_object().author:
         return super(PostUpdate, self).dispatch(request, *args, **kwargs)
      return PermissionDenied
   ```
   - `dispatch`: HTTP ìš”ì²­ì— ëŒ€í•´ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œë¡œ HTTP ë©”ì„œë“œì— ë”°ë¼ ì ì˜í•œ í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³  í•´ë‹¹ ë©”ì„œë“œì—ì„œ ë·°ì˜ ë¡œì§ì´ ì‹¤í–‰ëœë‹¤.

## ğŸ“ŒDeleteView
## ğŸ“ŒTemplateView
## ğŸ“ŒFormView

# 2. CBV ë©”ì„œë“œ
## ğŸ“Œ`get_context_data()`
```py
from django.views.generic import ListView, DetailView

class EntityView(ClassBaseView):
   def get_context_data(self, **kwargs):
      context = super(EntityView, self).get_context_data()
      context['key'] = subEntity.objects.all()
      return context
```
`ListView`ì—ì„œ ìƒì†ëœ ë©”ì„œë“œë¡œ ì»¨í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ë°˜í™˜í•˜ëŠ” ì—­í• ì´ë‹¤.
context(ë”•ì…˜ë„ˆë¦¬)ì— subEntityì˜ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.

## ğŸ“Œ`post_set.count()`
```html
<ul>
{% for item in categorys %}
   <li>
      {{item.name}}({{item.relatedEntity_set.count}})
   </li>
{% endfor %}
</ul>
```
ì—­ì°¸ì¡°ë¥¼ í†µí•´ ì—°ê²°ëœ ê°ì²´ìˆ˜ë¥¼ ì„¸ëŠ” ë©”ì„œë“œì´ë‹¤. ëª¨ë¸(`Entity`)ì„ ì°¸ì¡°í•˜ëŠ” ë‹¤ë¥¸ ëª¨ë¸(`Category`)ì—ì„œ ì—­ì°¸ì¡°í•  ë•Œ ì‚¬ìš©ë˜ëŠ” ì´ë¦„ì´ë‹¤.
   - `relatedEntity_set`: FK, ManyToMany ë“± ê°™ì´ ê´€ê³„í˜• í•„ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ğŸ“Œ`self.object`
```py
class EntityDetail(CreateView):
   def form_valid(self, form):
      self.object.tags.add(tag)
      self.object.tags.clear() # ëª¨ë¸ ê°ì²´ì˜ N:N ê´€ê³„ í•„ë“œì—ì„œ ì—°ê²°ëœ ëª¨ë“  ê°ì²´ë¥¼ í•´ì œí•œë‹¤.
```